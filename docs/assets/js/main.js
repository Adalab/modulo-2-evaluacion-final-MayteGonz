"use strict";const inputSearch=document.querySelector(".js-search"),btnSearch=document.querySelector(".btn-search"),sectionSearch=document.querySelector(".js-sectionSearch"),sectionFav=document.querySelector(".js-sectionFavorites"),preShows=document.querySelector(".js-recomendedShows"),btnclearFavs=document.querySelector(".js-btnClearFavs"),url="https://api.tvmaze.com/search/shows?q=",url2="https://api.tvmaze.com/search/shows?q=girls";let showsFound=[],showsFavs=[];const showsLS=JSON.parse(localStorage.getItem("shows")),showsFavsLS=JSON.parse(localStorage.getItem("showsFavs"));function renderPreShows(){null!==showsFavsLS&&(showsFavs=showsFavsLS,renderShowList(showsFavs,sectionFav,!0)),null!==showsLS?(showsFound=showsLS,renderShowList(showsFound,sectionSearch,!1)):fetch(url2).then(e=>e.json()).then(e=>{showsFound=e,renderShowList(showsFound,sectionSearch,!1),localStorage.setItem("shows",JSON.stringify(showsFound)),preShows.innerHTML="Series recomendadas para tÃ­"})}function requestShows(){const e=inputSearch.value;fetch(url+e).then(e=>e.json()).then(s=>{0===s.length?(preShows.innerHTML="Prueba a buscar de nuevo =(",sectionSearch.innerHTML=""):(preShows.innerHTML="Esto es lo que hemos encontrado: ",showsFound=s,renderShowList(showsFound,sectionSearch,!1)),""===e&&(renderPreShows(),preShows.innerHTML="")})}function renderOneShow(e,s){const t=document.createElement("article");t.classList.add("card");const o=document.createElement("h3");o.classList.add("titleShow"),o.textContent=e.show.name;const n=document.createElement("div");n.classList.add("topCard"),n.appendChild(o);const a=document.createElement("i");s||(t.classList.add("js-card"),a.classList.add("fa-regular","fa-bookmark")),t.setAttribute("id",e.show.id),-1!==showsFavs.findIndex(s=>s.show.id===e.show.id)&&(t.classList.add("favorite"),a.classList.remove("fa-regular"),a.classList.add("fa-solid"),s||t.classList.add("clickable")),n.appendChild(a);const r=document.createElement("img");if(r.alt="Imagen de portada de la peli "+e.show.name,e.show.image?r.src=e.show.image.medium:r.src="./assets/images/placeholderShow.jpg",r.classList.add("imgShow"),s){const s=document.createElement("button");s.classList.add("btnDelete"),s.classList.add("js-btnDelete");const t=document.createElement("i");t.classList.add("fa-solid","fa-x"),s.setAttribute("id",e.show.id),s.appendChild(t),n.appendChild(s)}return t.appendChild(n),t.appendChild(r),t}function renderShowList(e,s,t){s.innerHTML="";for(const o of e)s.appendChild(renderOneShow(o,t));addEventCardShow(),addEventBtnDelete()}function handleClickSearch(e){e.preventDefault(),requestShows()}function handleClickShow(e){const s=parseInt(e.currentTarget.id);let t=showsFound.find(e=>e.show.id===s);const o=showsFavs.findIndex(e=>e.show.id===s);-1===o?showsFavs.push(t):showsFavs.splice(o,1),renderShowList(showsFavs,sectionFav,!0),renderShowList(showsFound,sectionSearch,!1),localStorage.setItem("showsFavs",JSON.stringify(showsFavs))}function handleClickClear(){showsFavs=[],localStorage.removeItem("showsFavs"),renderShowList(showsFavs,sectionFav,!0),renderShowList(showsFound,sectionSearch,!1)}function handleClickDeleteOne(e){const s=parseInt(e.currentTarget.id),t=showsFavs.findIndex(e=>e.show.id===s);showsFavs.splice(t,1),renderShowList(showsFavs,sectionFav,!0),renderShowList(showsFound,sectionSearch,!1),localStorage.setItem("showsFavs",JSON.stringify(showsFavs))}function addEventCardShow(){const e=document.querySelectorAll(".js-card");for(const s of e)s.addEventListener("click",handleClickShow)}function addEventBtnDelete(){const e=document.querySelectorAll(".js-btnDelete");for(const s of e)s.addEventListener("click",handleClickDeleteOne)}btnSearch.addEventListener("click",handleClickSearch),renderPreShows(),btnclearFavs.addEventListener("click",handleClickClear);